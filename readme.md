[![paypal](https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif)](https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&encrypted=-----BEGIN PKCS7-----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-----END PKCS7-----)

Sitecore Security

This module contains the following functionalities:

* Removal of security headers
* Addition of the Content Security Policy (http://blog.baslijten.com/sitecore-security-3-prevent-xss-using-content-security-policy/, https://www.owasp.org/index.php/Content_Security_Policy)
* Addition of X-Frame-Options header, based on CSP settings
* Addition of X-XSS-Protection header, based on CSP settings
* Addition of X-Content-Type-Options header
* Addition of lets's encrypt options for Sitecore (http://blog.baslijten.com/sitecore-security-4-serve-your-site-securely-over-https-with-lets-encrypt/)
* XDT to create a redirect + addition of HSTS header (http://blog.baslijten.com/sitecore-security-2-secure-connections-and-how-to-force-the-browser-to-use-the-secure-connection/)
* XDT to configure security headers (https://www.akshaysura.com/2016/08/19/secure-sitecore-secure-headers-xss-protection/)
* XDT to set secure cookies
* XDT to set secure forms authentiction cookies
* Extension method to Rotate Session ID's -> when used during login and logout, Session ID is changed, this helps against session-fixation attacks. Todo: copy Session from old to new
* Addition of stronger password hashing algorithm (http://blog.baslijten.com/sitecore-security-1-how-to-replace-the-password-hashing-algorithm/) 
* Added Password reset tool. When hashing algorithm has been replaced, old passwords aren't useable anymore

todo:
* Script to create certificates to configure a local HTTPS site

prerequisites:
* URL Rewrite module

1) make sure unicorn is installed (Unicorn.Web may be used for this)
2) Sync the serialized items with unicorn
3) install Security.Web
4) execute the following powershell:
5) add the CSP Link template to your (basic) page template(s)
6) Create a new CSP or use  the default one
7) use the XDT to transform your web.config 


